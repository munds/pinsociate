---
import "../../styles/global.css";
import PRODUCTS from "../../data/products";
import CategoryNav from "../../components/CategoryNav.astro";
import Footer from "../../components/Footer.astro";
import AddToCart from "../../components/AddToCart.jsx";

export function getStaticPaths() {
    return PRODUCTS.map((product) => ({
        params: { id: product.id.toString() },
        props: { product },
    }));
}

const { product } = Astro.props;
---

<html lang="en">
    <head>
        <title>{product.name} | Pinsociate, Inc</title>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta
            name="description"
            content={product.description ||
                `Buy ${product.name} at Pinsociate.`}
        />
    </head>
    <body class="bg-slate-100 min-h-screen font-sans flex flex-col">
        <header
            class="bg-white shadow p-6 mb-8 flex justify-between items-center"
        >
            <a href="/" class="font-bold text-xl">Pinsociate, Inc</a>
            <nav>
                <a href="/products" class="hover:underline mr-4">Products</a>
                <a
                    href="/cart"
                    class="hover:text-blue-600 transition"
                    aria-label="View Cart"
                >
                    <svg
                        class="w-6 h-6 text-gray-700"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        viewBox="0 0 24 24"
                    >
                        <circle cx="9" cy="21" r="1.5"></circle>
                        <circle cx="18" cy="21" r="1.5"></circle>
                        <path
                            d="M3 6h2l3.6 10.59a1 1 0 0 0 .92.61h7.98a1 1 0 0 0 .92-.62L21 7H6"
                        ></path>
                    </svg>
                </a>
            </nav>
        </header>

        <main class="max-w-7xl mx-auto flex-grow w-full px-6">
            <CategoryNav activeCategory={product.category} />

            <div
                class="bg-white rounded-lg shadow-lg overflow-hidden mt-8 max-w-5xl mx-auto"
            >
                <div class="md:flex">
                    <div
                        class="md:w-1/2 p-8 bg-gray-50 flex items-center justify-center"
                    >
                        <img
                            src={product.image}
                            alt={product.name}
                            class="max-h-[500px] w-auto object-contain rounded-lg shadow-sm"
                        />
                    </div>
                    <div class="md:w-1/2 p-8 lg:p-12 flex flex-col">
                        <div class="mb-auto">
                            <h1
                                class="text-3xl lg:text-4xl font-bold text-gray-900 mb-4"
                            >
                                {product.name}
                            </h1>
                            <p
                                class="text-2xl text-blue-600 font-semibold mb-6"
                            >
                                ${product.price.toFixed(2)}
                            </p>

                            <div class="prose prose-slate mb-8">
                                <p
                                    class="text-gray-700 text-lg leading-relaxed"
                                >
                                    {
                                        product.description ||
                                            "No description available for this vintage treasure."
                                    }
                                </p>
                            </div>

                            <div
                                class="grid grid-cols-2 gap-4 mb-8 text-sm text-gray-600"
                            >
                                <div>
                                    <span
                                        class="font-semibold block text-gray-900"
                                        >Category:</span
                                    >
                                    {product.category}
                                </div>
                                {
                                    product.condition && (
                                        <div>
                                            <span class="font-semibold block text-gray-900">
                                                Condition:
                                            </span>
                                            <span class="capitalize">
                                                {product.condition}
                                            </span>
                                        </div>
                                    )
                                }
                                {
                                    product.availability && (
                                        <div>
                                            <span class="font-semibold block text-gray-900">
                                                Availability:
                                            </span>
                                            <span
                                                class={`capitalize font-medium ${product.availability === "in stock" ? "text-green-600" : "text-red-600"}`}
                                            >
                                                {product.availability}
                                            </span>
                                        </div>
                                    )
                                }
                            </div>
                        </div>

                        <div class="pt-6 border-t border-gray-100">
                            {
                                product.availability !== "out of stock" ? (
                                    <AddToCart client:load product={product} />
                                ) : (
                                    <div class="bg-gray-100 text-gray-500 py-3 px-6 rounded-lg text-center font-medium">
                                        Currently Out of Stock
                                    </div>
                                )
                            }
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <Footer />
    </body>
</html>
